services:
  opencode:
    container_name: ${CONTAINER_NAME:-opencode}
    image: ${IMAGE_NAME:-opencode:latest}
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "${HOST_PORT:-4096}:${OPENCODE_PORT:-4096}"
    environment:
      - OPENCODE_PORT=${OPENCODE_PORT:-4096}
      - OPENCODE_HOST=${OPENCODE_HOST:-0.0.0.0}
      - OPENCODE_SERVER_USERNAME=${OPENCODE_SERVER_USERNAME:-opencode}
      - OPENCODE_SERVER_PASSWORD=${OPENCODE_SERVER_PASSWORD:-}
      - PUID=${PUID:-1000}
      - PGID=${PGID:-998}
      - EXTRA_GID=${EXTRA_GID:-}
    volumes:
      - "${DATA_DIR:-./data}:/home/coder/"
    init: true
    restart: unless-stopped
